<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222"><meta name="generator" content="Hexo 7.3.0">

  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.6.0/css/all.min.css" integrity="sha256-5eIC48iZUHmSlSUz9XtjRyK2mzQkHScZY1WdMaoz74E=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"gnehz972.github.io","root":"/","images":"/images","scheme":"Muse","darkmode":false,"version":"8.21.1","exturl":false,"sidebar":{"position":"left","width_expanded":320,"width_dual_column":240,"display":"post","padding":18,"offset":12},"hljswrap":true,"copycode":{"enable":false,"style":null},"fold":{"enable":false,"height":500},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"}}</script><script src="/js/config.js"></script>

    <meta name="description" content="Google NotebookLM is the sharp AI spear, Android Paging3 lib is the tough shield.Let break this shield using the spear to learn.">
<meta property="og:type" content="article">
<meta property="og:title" content="Quick read paging3 source code by AI tool">
<meta property="og:url" content="https://gnehz972.github.io/posts/b6e04f0f/index.html">
<meta property="og:site_name" content="gnehz972">
<meta property="og:description" content="Google NotebookLM is the sharp AI spear, Android Paging3 lib is the tough shield.Let break this shield using the spear to learn.">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://gnehz972.github.io/posts/b6e04f0f/q1.png">
<meta property="og:image" content="https://gnehz972.github.io/posts/b6e04f0f/q2.png">
<meta property="og:image" content="https://gnehz972.github.io/posts/b6e04f0f/q3.png">
<meta property="og:image" content="https://gnehz972.github.io/posts/b6e04f0f/q4.png">
<meta property="og:image" content="https://gnehz972.github.io/posts/b6e04f0f/q5.png">
<meta property="og:image" content="https://gnehz972.github.io/posts/b6e04f0f/q6-1.png">
<meta property="og:image" content="https://gnehz972.github.io/posts/b6e04f0f/q6-2.png">
<meta property="og:image" content="https://gnehz972.github.io/posts/b6e04f0f/q7.png">
<meta property="article:published_time" content="2024-12-10T13:23:39.000Z">
<meta property="article:modified_time" content="2024-12-10T14:04:54.912Z">
<meta property="article:author" content="gnehz972">
<meta property="article:tag" content="AI">
<meta property="article:tag" content="NotebookLM">
<meta property="article:tag" content="Paging3">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://gnehz972.github.io/posts/b6e04f0f/q1.png">


<link rel="canonical" href="https://gnehz972.github.io/posts/b6e04f0f/">


<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"zh-CN","comments":true,"permalink":"https://gnehz972.github.io/posts/b6e04f0f/","path":"posts/b6e04f0f/","title":"Quick read paging3 source code by AI tool"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>Quick read paging3 source code by AI tool | gnehz972</title>
  








  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
<link rel="alternate" href="/atom.xml" title="gnehz972" type="application/atom+xml">
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <div class="column">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏" role="button">
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <p class="site-title">gnehz972</p>
      <i class="logo-line"></i>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger" aria-label="搜索" role="button">
    </div>
  </div>
</div>







</header>
        
  
  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-4"><a class="nav-link" href="#Context"><span class="nav-number">1.</span> <span class="nav-text">Context</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Preparation"><span class="nav-number">2.</span> <span class="nav-text">Preparation</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Chat-to-learn"><span class="nav-number">3.</span> <span class="nav-text">Chat to learn</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Summerize-diagram"><span class="nav-number">4.</span> <span class="nav-text">Summerize diagram</span></a></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">gnehz972</p>
  <div class="site-description" itemprop="description">Android/iOS/Web/BE/AI</div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">12</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/categories/">
        <span class="site-state-item-count">9</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">24</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>

        </div>
      </div>
    </div>

    
  </aside>


    </div>

    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://gnehz972.github.io/posts/b6e04f0f/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="gnehz972">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="gnehz972">
      <meta itemprop="description" content="Android/iOS/Web/BE/AI">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="Quick read paging3 source code by AI tool | gnehz972">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          Quick read paging3 source code by AI tool
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>
      

      <time title="创建时间：2024-12-10 21:23:39 / 修改时间：22:04:54" itemprop="dateCreated datePublished" datetime="2024-12-10T21:23:39+08:00">2024-12-10</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Andriod/" itemprop="url" rel="index"><span itemprop="name">Andriod</span></a>
        </span>
          ，
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Andriod/AI/" itemprop="url" rel="index"><span itemprop="name">AI</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody"><p>Google NotebookLM is the sharp AI spear, Android Paging3 lib is the tough shield.<br>Let break this shield using the spear to learn.</p>
<span id="more"></span>
<h4 id="Context"><a href="#Context" class="headerlink" title="Context"></a>Context</h4><p>Paging3 is a complicate Android lib with a bunch of classes to do the paging stuff, although it hard to understand and use, but we use it for now and need to known the details. The article here introduce a way to read and understand the lib source code quickly by leveraging the AI tool of Google NotebookLM.</p>
<p>The initial purpose it to understand how the prepend loading is triggered, is it able to manually triggered with flexibility, while dive deep into it, it really deep to follow, lots of classes and concepts is defined to achieve the purpose. NotebookLM come rescue me from the headache.</p>
<p>By pasting all the source code to it as context, it knowns relationship between classes, it explains concept well. It even draw the nice diagrams with little modified input. And the most detailed and accurate is the explanation of the functions.</p>
<h4 id="Preparation"><a href="#Preparation" class="headerlink" title="Preparation"></a>Preparation</h4><ol>
<li>Download all the paging3 source code using <a href="https://downgit.github.io/#/home">https://downgit.github.io/#/home</a><ul>
<li>Paging3 common lib source code: <a href="https://github.com/androidx/androidx/tree/androidx-main/paging/paging-common/src/commonMain/kotlin/androidx/paging">https://github.com/androidx/androidx/tree/androidx-main/paging/paging-common/src/commonMain/kotlin/androidx/paging</a></li>
</ul>
</li>
<li>Use <code>copy-files-to-clipboard-for-llm</code> plugin to merge all the files and copy to clipboard</li>
<li>Paste the source code to NotebookLM as the reference source</li>
<li>Chat with NotebookLM for your need</li>
</ol>
<h4 id="Chat-to-learn"><a href="#Chat-to-learn" class="headerlink" title="Chat to learn"></a>Chat to learn</h4><p>Here I will list some core questions to figure out the prepend triggering flow and related concepts defined by the lib.</p>
<p><img src="/posts/b6e04f0f/q1.png"><br><img src="/posts/b6e04f0f/q2.png"><br><img src="/posts/b6e04f0f/q3.png"><br><img src="/posts/b6e04f0f/q4.png"><br><img src="/posts/b6e04f0f/q5.png"><br><img src="/posts/b6e04f0f/q6-1.png"><br><img src="/posts/b6e04f0f/q6-2.png"><br><img src="/posts/b6e04f0f/q7.png"></p>
<h4 id="Summerize-diagram"><a href="#Summerize-diagram" class="headerlink" title="Summerize diagram"></a>Summerize diagram</h4><blockquote>
<p>Q8-1 draw a sequence diagram to present the the flow of prepend loading<br>Q8-2 add LazyPageingItems in the sequence diagra</p>
</blockquote>
<pre><code class="highlight mermaid">
sequenceDiagram

participant UI

participant LazyPagingItems

participant PagingDataPresenter

participant HintReceiver

participant PageFetcher

participant PageFetcherSnapshot

participant PageFetcherSnapshotState

participant PagingSource

UI-&gt;&gt;LazyPagingItems: Access item (get)

activate UI

activate LazyPagingItems

LazyPagingItems-&gt;&gt;PagingDataPresenter: Get item at index (get)

activate PagingDataPresenter

PagingDataPresenter-&gt;&gt;PagingDataPresenter: Get item from page store

PagingDataPresenter-&gt;&gt;HintReceiver: Access Hint (ViewportHint)

deactivate UI

activate HintReceiver

HintReceiver-&gt;&gt;PageFetcher: Access Hint (ViewportHint)

deactivate HintReceiver

activate PageFetcher

PageFetcher-&gt;&gt;PageFetcherSnapshot: Access Hint (ViewportHint)

activate PageFetcherSnapshot

PageFetcherSnapshot-&gt;&gt;PageFetcherSnapshot: Wrap hint with generationId (GenerationalViewportHint)

PageFetcherSnapshot-&gt;&gt;PageFetcherSnapshotState: Get next load key (nextLoadKeyOrNull)

activate PageFetcherSnapshotState

PageFetcherSnapshotState--&gt;&gt;PageFetcherSnapshot: Return load key

deactivate PageFetcherSnapshotState

alt Valid load key and prefetch distance not fulfilled

PageFetcherSnapshot-&gt;&gt;PagingSource: Load data (load, LoadParams&#123;loadType=PREPEND, key, loadSize&#125;)

activate PagingSource

PagingSource-&gt;&gt;PagingSource: Fetch data

PagingSource--&gt;&gt;PageFetcherSnapshot: Load result (LoadResult&#123;Page/Error&#125;)

deactivate PagingSource

PageFetcherSnapshot-&gt;&gt;PageFetcherSnapshotState: Insert page, update load state, check for drop (insert)

activate PageFetcherSnapshotState

PageFetcherSnapshotState--&gt;&gt;PageFetcherSnapshot: Confirmation

deactivate PageFetcherSnapshotState

else Load key invalid or prefetch distance fulfilled

PageFetcherSnapshot-&gt;&gt;PageFetcherSnapshot: Skip load

end
deactivate PageFetcherSnapshot
deactivate PageFetcher
deactivate PagingDataPresenter
LazyPagingItems--&gt;&gt;UI: Return item
deactivate LazyPagingItems
</code></pre>

<blockquote>
<p>Q9 draw a class diagram using components in the above sequence diagram</p>
</blockquote>
<pre><code class="highlight mermaid">
classDiagram

class UI

class LazyPagingItems &#123;
-flow: Flow&lt;PagingData&lt;T&gt;&gt;
-pagingDataPresenter: PagingDataPresenter&lt;T&gt;
+refresh()
+loadState: CombinedLoadStates
+get(index: Int): T?
&#125;


class PagingDataPresenter &#123;
-hintReceiver: HintReceiver
-uiReceiver: UiReceiver
-pageStore: PageStore
+refresh()
+get(index: Int) : T?
+addLoadStateListener(listener)
+removeLoadStateListener(listener)
+presentPagingDataEvent(event: PagingDataEvent)
&#125;


class HintReceiver &#123;
+accessHint(hint: ViewportHint)
&#125;


class PageFetcher &#123;
-snapshot: PageFetcherSnapshot
+refresh()
&#125;


class PageFetcherSnapshot &#123;
-pagingSource: PagingSource
-stateHolder: PageFetcherSnapshotState.Holder
+doLoad(loadType: LoadType, hint: GenerationalViewportHint)
+doInitialLoad()
&#125;


class PageFetcherSnapshotState &#123;
-pages: List&lt;TransformablePage&lt;Key, Value&gt;&gt;
-placeholdersBefore: Int
-placeholdersAfter: Int
+insert(generationId: Int, loadType: LoadType, page: Page) : Boolean
+nextLoadKeyOrNull(loadType: LoadType, generationId: Int, presentedItemsBeyondAnchor: Int) : Key?
&#125;


class PagingSource &#123;
+load(params: LoadParams) : LoadResult
&#125;

UI ..&gt; LazyPagingItems
LazyPagingItems *-- PagingDataPresenter
PagingDataPresenter ..&gt; HintReceiver
HintReceiver ..&gt; PageFetcher
PageFetcher *-- PageFetcherSnapshot
PageFetcherSnapshot *-- PageFetcherSnapshotState
PageFetcherSnapshot ..&gt; PagingSource</code></pre>

    </div>

    
    
    

    <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/AI/" rel="tag"># AI</a>
              <a href="/tags/NotebookLM/" rel="tag"># NotebookLM</a>
              <a href="/tags/Paging3/" rel="tag"># Paging3</a>
          </div>

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/posts/3a9d928e/" rel="prev" title="Quick learn GraphQL basics by asking AI">
                  <i class="fa fa-angle-left"></i> Quick learn GraphQL basics by asking AI
                </a>
            </div>
            <div class="post-nav-item">
            </div>
          </div>
    </footer>
  </article>
</div>






</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">

  <div class="copyright">
    &copy; 
    <span itemprop="copyrightYear">2024</span>
    <span class="with-love">
      <i class="fa fa-heart"></i>
    </span>
    <span class="author" itemprop="copyrightHolder">gnehz972</span>
  </div>
  <div class="powered-by">由 <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/muse/" rel="noopener" target="_blank">NexT.Muse</a> 强力驱动
  </div>

    </div>
  </footer>

  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>
  <div class="sidebar-dimmer"></div>
  <div class="back-to-top" role="button" aria-label="返回顶部">
    <i class="fa fa-arrow-up fa-lg"></i>
    <span>0%</span>
  </div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/sidebar.js"></script><script src="/js/next-boot.js"></script>

  

  <script class="next-config" data-name="mermaid" type="application/json">{"enable":true,"theme":{"light":"default","dark":"dark"},"js":{"url":"https://cdnjs.cloudflare.com/ajax/libs/mermaid/11.4.0/mermaid.min.js","integrity":"sha256-G8ouPAnw4zzMbnAenHnVz6h9XpKbNdOkrqTh7AadyHs="}}</script>
  <script src="/js/third-party/tags/mermaid.js"></script>





  





</body>
</html>
